# VSCode Vim 进阶指南

## 1. 高效移动

### 1.1 单行移动
- `0`: 移动到行首
- `$`: 移动到行尾
- `^`: 移动到行首第一个非空字符
- `g_`: 移动到行尾最后一个非空字符
- `f{char}`: 向后查找字符
- `F{char}`: 向前查找字符
- `t{char}`: 向后查找字符前
- `T{char}`: 向前查找字符前

### 1.2 多行移动
- `gg`: 文件开头
- `G`: 文件结尾
- `{`: 上一段落
- `}`: 下一段落
- `ctrl+u`: 向上翻页
- `ctrl+d`: 向下翻页
- `:n`: 跳转到第n行

### 1.3 EasyMotion
EasyMotion 是一个强大的快速移动插件：
- `<leader><leader>w`: 向后标记单词
- `<leader><leader>b`: 向前标记单词
- `<leader><leader>j`: 向下标记行
- `<leader><leader>k`: 向上标记行

## 2. 文本编辑技巧

### 2.1 复制粘贴
- `yy`: 复制当前行
- `dd`: 剪切当前行
- `p`: 在当前位置后粘贴
- `P`: 在当前位置前粘贴

### 2.2 文本对象
- `ciw`: 改变当前单词
- `ci"`: 改变双引号中的内容
- `ci(`: 改变括号中的内容
- `cit`: 改变 HTML 标签中的内容

### 2.3 多光标操作
- `gb`: 选择下一个相同的本
- `gh`: 进入选择模式
- 可视模式下 `I`: 在选中行的开头插入
- 可视模式下 `A`: 在选中行的结尾插入

## 3. 搜索替换

### 3.1 基本搜索
- `/pattern`: 向后搜索
- `?pattern`: 向前搜索
- `n`: 下一个匹配
- `N`: 上一个匹配

### 3.2 替换命令
```
:[range]s/{pattern}/{string}/[flags]
```
- `:%s/foo/bar/g`: 全文替换
- `:s/foo/bar/g`: 当前行替换
- `:'<,'>s/foo/bar/g`: 选中区域替换

## 4. 寄存器使用

### 4.1 寄存器类型
- `"ayy`: 复制到寄存器 a
- `"ap`: 从寄存器 a 粘贴
- `"+y`: 复制到系统剪贴板
- `"+p`: 从系统剪贴板粘贴

### 4.2 宏录制
1. `qa` 开始录制到寄存器 a
2. 执行操作序列
3. `q` 停止录制
4. `@a` 执行宏
5. `@@` 重复上次的宏

## 5. VSCode 特定功能

### 5.1 命令面板集成
- `<leader>f`: 打开文件搜索
- `<leader>e`: 切换侧边栏
- `<leader>t`: 切换终端
- `<leader>[1-7]`: 切换到对应标签页

### 5.2 自定义快捷键
```json
"vim.normalModeKeyBindingsNonRecursive": [
    {
        "before": ["K"],
        "commands": ["lineBreakInsert"],
        "silent": true
    },
    {
        "before": ["S"],
        "commands": ["workbench.action.files.save"],
        "silent": true
    }
]
```

## 6. 最佳实践

### 6.1 提高效率的建议
1. 尽量使用操作符+动作命令的组合
2. 善用文本对象
3. 合理使用宏来自动化重复操作
4. 使用 EasyMotion 进行快速移动
5. 熟练使用寄存器管理剪贴板

### 6.2 常见陷阱
1. 避免使用方向键，坚持使用 hjkl
2. 不要过度依赖可视模式
3. 注意命令的可重复性
4. 合理使用 . 命令重复上次操作

## 7. 调试技巧

### 7.1 VSCode Vim 状态栏
- 通过状态栏颜色区分不同模式
- 查看当前模式和命令状态
- 监控宏录制状态

### 7.2 问题排查
1. 检查快捷键冲突
2. 查看命令面板日志
3. 禁用可能冲突的插件
4. 重置 VSCode Vim 配置 

## 8. 高级文本操作

### 8.1 文本对象进阶
- `vip`: 选择当前段落
- `vi{`: 选择花括号内内容
- `va[`: 选择方括号及其内容
- `vat`: 选择 HTML 标签块
- `vis`: 选择当前句子

### 8.2 折叠操作
- `zf`: 创建折叠
- `zo`: 打开折叠
- `zc`: 关闭折叠
- `zR`: 打开所有折叠
- `zM`: 关闭所有折叠

### 8.3 标记和跳转
- `ma`: 设置标记 a
- `'a`: 跳转到标记 a 所在行
- `` `a ``: 跳转到标记 a 的确切位置
- `'.`: 跳转到最后修改的位置
- `''`: 跳转到上次跳转位置

## 9. 窗口管理

### 9.1 分屏操作
- `<leader>v`: 垂直分屏
- `<leader>s`: 水平分屏
- `<C-w>h/j/k/l`: 在窗口间移动
- `<C-w>H/J/K/L`: 移动窗口位置
- `<C-w>=`: 平均分配窗口大小

### 9.2 标签页管理
- `gt`: 下一个标签页
- `gT`: 上一个标签页
- `:tabnew`: 新建标签页
- `:tabclose`: 关闭当前标签页
- `:tabs`: 列出所有标签页

## 10. 插件集成

### 10.1 Surround.vim
- `ys{motion}{char}`: 添加包围
- `cs{old}{new}`: 改变包围
- `ds{char}`: 删除包围
- `S{char}`: 可视模式下添加包围

### 10.2 Commentary
- `gcc`: 注释/取消注释当前行
- `gc{motion}`: 注释/取消注释选中区域
- `gC`: 块注释

## 11. 效率提升技巧

### 11.1 命令行模式技巧
- `:w !sudo tee %`: 用 sudo 权限保存
- `:earlier 1m`: 回到1分钟前的状态
- `:later 1m`: 回到1分钟后的状态
- `:g/pattern/d`: 删除匹配行
- `:v/pattern/d`: 删除不匹配行

### 11.2 正则表达式
```vim
:%s/\v(\w+)/\u\1/g  " 首字母大写
:%s/\v(\d{3})(\d{3})/\1-\2/g  " 数字分组
:%s/\v^(.*)$/"\1"/g  " 添加引号
```

### 11.3 自动补全
- `<C-n>`: 普通补全
- `<C-x><C-l>`: 整行补全
- `<C-x><C-f>`: 文件路径补全
- `<C-x><C-o>`: 智能补全

## 12. 调试和性能优化

### 12.1 性能问题排查
1. 禁用不必要的插件
2. 减少复杂的映射
3. 优化搜索和替换操作
4. 使用异步操作

### 12.2 常见问题解决
1. 按键延迟：调整 `timeoutlen` 和 `ttimeoutlen`
2. 复制粘贴问题：使用 `:set paste` 模式
3. 中文输入法切换：使用 `im-select`
4. 快捷键冲突：检查 `keybindings.json`

## 13. 工作流程优化

### 13.1 项目管理
- 使用工作区
- 配置项目特定设置
- 创建任务快捷键
- 集成版本控制

### 13.2 代码重构
1. 提取函数：选中代码块后使用重构命令
2. 变量重命名：使用 LSP 的重命名功能
3. 移动代码：使用可视模式和寄存器
4. 格式化代码：使用 `=` 操作符

### 13.3 自定义代码片段
```json
{
    "Print to console": {
        "prefix": "log",
        "body": [
            "console.log('$1');",
            "$2"
        ],
        "description": "Log output to console"
    }
}
```

